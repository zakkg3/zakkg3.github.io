
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://flag5.com./clustersecret/">
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.2.14">
    
    
      
        <title>ClusterSecret</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.3de6f41f.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.cc9b2e1e.min.css">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL(".",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#clustersecret" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="." title="ClusterSecret" class="md-header__button md-logo" aria-label="ClusterSecret" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ClusterSecret
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              ClusterSecret
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/zakkg3/ClusterSecret" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="ClusterSecret" class="md-nav__button md-logo" aria-label="ClusterSecret" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    ClusterSecret
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/zakkg3/ClusterSecret" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          ClusterSecret
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="." class="md-nav__link md-nav__link--active">
        ClusterSecret
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#use-cases" class="md-nav__link">
    Use cases.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    installation
  </a>
  
    <nav class="md-nav" aria-label="installation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#requirements" class="md-nav__link">
    Requirements
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tldr-install" class="md-nav__link">
    tl;dr install
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-by-step" class="md-nav__link">
    step by step
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quick-start" class="md-nav__link">
    quick start:
  </a>
  
    <nav class="md-nav" aria-label="quick start:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get-the-clustersecrets" class="md-nav__link">
    Get the clustersecrets
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minimal-example" class="md-nav__link">
    Minimal example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#limit-clustersecret-to-certain-namespaces" class="md-nav__link">
    Limit ClusterSecret to certain namespaces.
  </a>
  
    <nav class="md-nav" aria-label="Limit ClusterSecret to certain namespaces.">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#update-a-clustersecret-object" class="md-nav__link">
    Update a ClusterSecret object
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#value-from-another-secret" class="md-nav__link">
    Value From another secret.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#optional" class="md-nav__link">
    optional
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dev-debugging" class="md-nav__link">
    Dev &amp; Debugging.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dev-run-it-in-your-terminal" class="md-nav__link">
    Dev: Run it in your terminal.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#build-the-images" class="md-nav__link">
    Build the images
  </a>
  
    <nav class="md-nav" aria-label="Build the images">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#x86" class="md-nav__link">
    x86
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#arm32v7" class="md-nav__link">
    ARM32v7
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#digests" class="md-nav__link">
    Digests
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#roadmap" class="md-nav__link">
    Roadmap:
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#use-cases" class="md-nav__link">
    Use cases.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    installation
  </a>
  
    <nav class="md-nav" aria-label="installation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#requirements" class="md-nav__link">
    Requirements
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tldr-install" class="md-nav__link">
    tl;dr install
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-by-step" class="md-nav__link">
    step by step
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quick-start" class="md-nav__link">
    quick start:
  </a>
  
    <nav class="md-nav" aria-label="quick start:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get-the-clustersecrets" class="md-nav__link">
    Get the clustersecrets
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minimal-example" class="md-nav__link">
    Minimal example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#limit-clustersecret-to-certain-namespaces" class="md-nav__link">
    Limit ClusterSecret to certain namespaces.
  </a>
  
    <nav class="md-nav" aria-label="Limit ClusterSecret to certain namespaces.">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#update-a-clustersecret-object" class="md-nav__link">
    Update a ClusterSecret object
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#value-from-another-secret" class="md-nav__link">
    Value From another secret.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#optional" class="md-nav__link">
    optional
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dev-debugging" class="md-nav__link">
    Dev &amp; Debugging.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dev-run-it-in-your-terminal" class="md-nav__link">
    Dev: Run it in your terminal.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#build-the-images" class="md-nav__link">
    Build the images
  </a>
  
    <nav class="md-nav" aria-label="Build the images">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#x86" class="md-nav__link">
    x86
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#arm32v7" class="md-nav__link">
    ARM32v7
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#digests" class="md-nav__link">
    Digests
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#roadmap" class="md-nav__link">
    Roadmap:
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
  <a href="https://github.com/zakkg3/ClusterSecret/edit/master/docs/index.md" title="Edit this page" class="md-content__button md-icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>



<h1 id="clustersecret">ClusterSecret</h1>
<p><img alt="CI" src="https://github.com/zakkg3/ClusterSecret/workflows/CI/badge.svg" /> <a href="https://bestpractices.coreinfrastructure.org/projects/4283"><img alt="CII Best Practices" src="https://bestpractices.coreinfrastructure.org/projects/4283/badge" /></a><a href="http://www.apache.org/licenses/LICENSE-2.0.html"><img alt="License" src="http://img.shields.io/:license-apache-blue.svg" /></a></p>
<hr />
<p>Kubernetes ClusterSecret </p>
<p>Global inter-namespace cluster secrets - Secrets that work across namespaces  - Clusterwide secrets</p>
<p>ClusterSecret operator makes sure all the matching namespaces have the secret available. New namespaces, if they match the pattern, will also have the secret.
Any change on the ClusterSecret will update all related secrets. Deleting the ClusterSecret deletes "child" secrets (all cloned secrets) too.</p>
<p><img align="left" alt="Cluster Secret overview" src="https://github.com/zakkg3/ClusterSecret/blob/master/docs/clusterSecret.png" /></p>
<hr />
<p>Here is how it looks like:</p>
<pre><code class="language-yaml">Kind: ClusterSecret
apiVersion: clustersecret.io/v1
metadata:
  namespace: clustersecret
  name: default-wildcard-certifiate
matchNamespace:
  - prefix_ns-*
  - anothernamespace
avoidNamespaces:
  - supersecret-ns
data:
  tls.crt: BASE64
  tls.key: BASE64
</code></pre>
<h2 id="use-cases">Use cases.</h2>
<p>Use it for certificates, registry pulling credentials and so on.</p>
<p>when you need a secret in more than one namespace. you have to: </p>
<p>1- Get the secret from the origin namespace.
2- Edit the  the secret with the new namespace.
3- Re-create the new secret in the new namespace. </p>
<p>This could be done with one command:</p>
<pre><code class="language-bash">kubectl get secret &lt;secret-name&gt; -n &lt;source-namespace&gt; -o yaml \
| sed s/&quot;namespace: &lt;source-namespace&gt;&quot;/&quot;namespace: &lt;destination-namespace&gt;&quot;/\
| kubectl apply -n &lt;destination-namespace&gt; -f -
</code></pre>
<p>Clustersecrets automates this. It keep track of any modification in your secret and it will also react to new namespaces. </p>
<h2 id="installation">installation</h2>
<h3 id="requirements">Requirements</h3>
<p>Current version 0.0.7 is tested for Kubernetes &gt;= 1.19 up to 1.25</p>
<p>For older kubernes (&lt;1.19) use the image tag "0.0.6" in  yaml/02_deployment.yaml</p>
<h3 id="tldr-install">tl;dr install</h3>
<pre><code class="language-bash">kubectl apply -f ./yaml
</code></pre>
<h3 id="step-by-step">step by step</h3>
<p>To instal ClusterSecret operator we need to create (in this order):</p>
<ul>
<li>RBAC resources (avoid if you are not running RBAC) to allow the operator to create/update/patch secrets: yaml/00_</li>
<li>Custom resource definition for the ClusterSecret resource: yaml/01_crd.yaml</li>
<li>The ClusterSecret operator itself: yaml/02_deployment.yaml || For <strong>ARM architectures</strong>: yaml/arm32v7/02_deployment.yam</li>
</ul>
<h2 id="quick-start">quick start:</h2>
<p>create a ClusterSecret object yaml like the one above, or in the example in yaml/Object_example/obj.yaml and apply it in your cluster <code>kubectl apply -f yaml/Object_example/obj.yaml</code></p>
<p>The ClusterSecret operator will pick it up and will create the secret in every matching namespace:  match <code>matchNamespace</code> but not matching  <code>avoidNamespaces</code> RegExp's.</p>
<p>You can specify multiple matching or non-matching RegExp. By default it will match all, same as defining matchNamespace = * </p>
<h3 id="get-the-clustersecrets">Get the clustersecrets</h3>
<pre><code class="language-bash">$&gt; kubectl get csec -n clustersecret
NAME            TYPE
global-secret
</code></pre>
<h3 id="minimal-example">Minimal example</h3>
<pre><code class="language-yaml">apiVersion: clustersecret.io/v1
kind: ClusterSecret
metadata:
  name: global-secret
  namespace: my-fav-namespce
data:
  username: MTIzNDU2Cg==
  password: Nzg5MTAxMTIxMgo=
</code></pre>
<h2 id="limit-clustersecret-to-certain-namespaces">Limit ClusterSecret to certain namespaces.</h2>
<p>This can be archived by changing the RBAC.
You may want to replace https://github.com/zakkg3/ClusterSecret/blob/master/yaml/00_rbac.yaml#L43-L46
for a new namespaced role and its correspondent rolebinding.</p>
<p>Here is the official doc:
https://kubernetes.io/docs/reference/access-authn-authz/rbac/</p>
<h3 id="update-a-clustersecret-object">Update a ClusterSecret object</h3>
<p>This will trigger the operator to also update all secrets that it matches.</p>
<h3 id="value-from-another-secret">Value From another secret.</h3>
<p>With this we can tell ClusterSecret to take the values from an existing secret.
yaml/Object_example/value-from-obj.yaml have a working example. Note that you will need first to have the obj2.yaml applied (the source secret).</p>
<pre><code>data:
  valueFrom:
    secretKeyRef:
      name: &lt;secre-name&gt;
      namespace: &lt;source-namespace&gt;
</code></pre>
<p>to-do is to specify keys or matched keys to only sync that ones. For now it will sync the whole secret.</p>
<h3 id="optional">optional</h3>
<p>overwrite the deployment command with kopf namespaces instead of the "-A" (all namespaces)</p>
<h2 id="dev-debugging">Dev &amp; Debugging.</h2>
<p><strong>NOTE</strong>: in <strong>debug mode</strong> object data (the secret) are sent to stdout, potentially logs are being collected by Loki / Elasticsearch or any log management platform -&gt; <strong>Not for production!</strong>.</p>
<p>Overwirte deployment entrypoint (Kubernetes <code>command</code>) from <code>kopf run /src/handlers.py</code> to <code>kopf run /src/handlers.py --verbose</code></p>
<h2 id="dev-run-it-in-your-terminal">Dev: Run it in your terminal.</h2>
<p>For development you dont want to build/push/recreate pod every time. Instead we can run the operator locally:</p>
<p>Once you have the config in place (kubeconfig) you can just install the requirementes (pip install /base-image/requirements.txt) and then run the operator from your machine (usefull for debbuging.)</p>
<pre><code class="language-bash">kopf run ./src/handlers.py --verbose
</code></pre>
<p>Make sure to have the proper RBAC in place (<code>k apply -f yaml/00_rbac.yaml</code>) and also the CRD definition (<code>k apply -f yaml/01_crd.yaml</code>)</p>
<h2 id="build-the-images">Build the images</h2>
<p>There is makefiles for this, you can clone this repo. edit the makefile and then run 'make all'.</p>
<p>You will need the base image first and then the final image.
Find the base one in the folder base-image (yes very original name)</p>
<p>Running just 'make' builds and push for all arch's supported. </p>
<h3 id="x86">x86</h3>
<pre><code>cd base-images &amp;&amp; make all &amp; cd ..
make all
</code></pre>
<h3 id="arm32v7">ARM32v7</h3>
<p>In case you want it for your raspberri py:</p>
<pre><code>cd base-images &amp;&amp; make arm &amp; cd ..
make arm
</code></pre>
<h3 id="digests">Digests</h3>
<p>latest = 0.0.7</p>
<p>docker.io/flag5/clustersecret:</p>
<p>0.0.7 digest: sha256:c8dffeefbd3c8c54af67be81cd769e3c18263920729946b75f098065318eddb1
0.0.7_arm32: digest: sha256:ffac630417bd090c958c9facf50a31ba54e0b18c89ef52d8eec5c1326a5f20ad</p>
<h2 id="roadmap">Roadmap:</h2>
<p>Tag 0.0.8:
 - [X] implement <code>source</code> to specify a source secret to sync instead of <code>data</code> field. (https://github.com/zakkg3/ClusterSecret/issues/3)</p>
<hr />
<h1 id="support">Support</h1>
<p>If you need support, start with the troubleshooting guide: Run it in debug mode.
 You can open issues and we will try to address them. </p>
<p>That said, if you have questions, or just want to establish contact, reach out one way or another. <a href="https://flag5.com">https://flag5.com</a> || nico at flag5.com</p>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": ".", "features": [], "search": "assets/javascripts/workers/search.2a1c317c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="assets/javascripts/bundle.c2e1ee47.min.js"></script>
      
    
  </body>
</html>